{% extends "base.html" %}
{% block content %}
    <div class="row">
        <div class="col-sm-2"></div>
        <div class="col-sm-8">
            {% for message in get_flashed_messages(with_categories=True) %}
                <div class="alert alert-{{ message[0] }}">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{ message[1] }}
                </div>
            {% endfor %}
            <form action="/admin-page" method="post">
                <table id="userTable" class="display table table-striped table-bordered" cellspacing="0"
                       width="100%">
                    <thead>
                    <tr>
                        <th>Username</th>
                        <th>First name</th>
                        <th>Last name</th>
                        <th>Email</th>
                        <th>Status</th>
                        <th style="text-align: center;">Active</th>
                        <th>Delete</th>

                    </tr>
                    </thead>
                    <tbody>
                    {% for user in users %}
                        <tr>
                            <td>{{ user.username }}</td>
                            <td>{{ user.firstname }}</td>
                            <td>{{ user.lastname }}</td>
                            <td>{{ user.email }}</td>
                            <td>{{ user.status }}</td>
                            <td style="text-align: center;">
                                <input id="{{ user.username }}"
                                       name="{{ user.username }}"
                                       {% if user.is_active %}checked{% endif %}
                                       type="checkbox" class="form-check-input">
                            </td>
                            <td style="text-align: center;">
                                <button type="button" class="btn btn-xs btn-danger" id="button-delete-user"
                                        data-user="{{ user.username }}" onclick="deleteUser(this);"
                                        {% if user.status == 'admin' %}disabled{% endif %}>
                                    &times;
                                </button>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <br>
                <button type="submit" class="btn btn-default">Submit</button>
            </form>
        </div>
        <div class="col-sm-2"></div>
    </div>
    <script>
        function deleteUser(button) {
            var user = $(button).data('user');
            $.ajax({
                type: 'DELETE',
                url: window.location.pathname + '/' + user + '/delete',
                success: function () {
                    window.location.reload();
                }
            })
        }
    </script>
{% endblock %}

